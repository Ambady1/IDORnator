{% extends "base.html" %}

{% block head %}
<title>IDORnator</title>
<link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
{% endblock %}

{% block body %}
<div class="container">
    <div class="header">
        <pre>
            .___________   ________ __________               __                
            |   \______ \  \_____  \\______   \ ____ _____ _/  |_  ___________ 
            |   ||    |  \  /   |   \|       _//    \\__  \\   __\/  _ \_  __ \
            |   ||    `   \/    |    \    |   \   |  \/ __ \|  | (  <_> )  | \/
            |___/_______  /\_______  /____|_  /___|  (____  /__|  \____/|__|   
                        \/         \/       \/     \/     \/                   
        </pre>
    </div>
    <form method="POST" action="/" id="mainForm">
        <div class="form-group">
            <label for="mode">Enter the Mode:</label>
            <select name="mode" id="mode" required>
                <option value="IDOR">IDOR</option>
                <option value="BAC">BAC</option>
            </select>
        </div>
        <div class="form-group">
            <label for="Depth">Enter the Depth:</label>
            <select name="Depth" id="Depth" required>
                <option value="High">High</option>
                <option value="Medium">Medium</option>
                <option value="Low">Low</option>
            </select>
        </div>
        
        <!-- IDOR Mode Fields -->
        <div id="urlGroup" class="form-group">
            <div class="form-group">
                <label for="urlIDOR">Enter the URL:</label>
                <input type="text" id="urlIDOR" name="url" placeholder="https://example.com" required>
            </div>
            <div class="form-group">
                <label for="cookie">Enter any associated cookie</label>
                <input type="text" id="cookie" name="cookie" placeholder="session-cookie">
            </div>
        </div>
        
        <!-- BAC Mode Fields -->
        <div id="tokenGroup" class="form-group" style="display:none;">
            <div class="form-group">
                <label for="urlBAC">Enter the URL:</label>
                <input type="text" id="urlBAC" name="url" placeholder="https://example.com">
            </div>
            <div class="form-group">
                <label for="lower_token">Enter the lower privilege token:</label>
                <input type="text" id="lower_token" name="lower_token" placeholder="ha5da6gahfafkajjhe">
            </div>
            <div class="form-group">
                <label for="higher_token">Enter the higher privilege token:</label>
                <input type="text" id="higher_token" name="higher_token" placeholder="ha5da6gahfafkajjhe">
            </div>
        </div>
        
        <button class="btn" type="submit">Submit</button>
    </form>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const modeSelect = document.getElementById('mode');
    const urlGroup = document.getElementById('urlGroup');
    const tokenGroup = document.getElementById('tokenGroup');

    const urlIDOR = document.getElementById('urlIDOR');
    const urlBAC = document.getElementById('urlBAC');
    const lowerToken = document.getElementById('lower_token');
    const higherToken = document.getElementById('higher_token');

    function toggleFormGroups() {
        if (modeSelect.value === 'IDOR') {
            urlGroup.style.display = 'block';
            tokenGroup.style.display = 'none';

            // Make IDOR fields required
            urlIDOR.required = true;
            urlBAC.required = false;
            lowerToken.required = false;
            higherToken.required = false;
        } else if (modeSelect.value === 'BAC') {
            urlGroup.style.display = 'none';
            tokenGroup.style.display = 'block';

            // Make BAC fields required
            urlIDOR.required = false;
            urlBAC.required = true;
            lowerToken.required = true;
            higherToken.required = true;
        }
    }

    modeSelect.addEventListener('change', toggleFormGroups);
    toggleFormGroups();
});
</script>
{% endblock %}
