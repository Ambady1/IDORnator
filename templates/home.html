{% extends "base.html" %}

{% block head %}
<title>IDORnator</title>
<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
{% endblock %}

{% block body %}
<div class="w-full min-h-screen flex flex-col items-center justify-center bg-[##212121] text-white p-6">
    <!-- Wrapper div to ensure vertical alignment -->
    <div class="flex flex-col items-center w-full">

        <div class="flex justify-center items-center text-center w-full mx-[0%] mr-[10%] my-[0%]">
            <pre class="text-2xl text-[#FFA500] mb-8 font-mono">
                .___________   ________ __________               __                
                |   \______ \  \_____  \\______   \ ____ _____ _/  |_  ___________ 
                |   ||    |  \  /   |   \|       _//    \\__  \\   __\/  _ \_  __ \
                |   ||    `   \/    |    \    |   \   |  \/ __ \|  | (  <_> )  | \/
                |___/_______  /\_______  /____|_  /___|  (____  /__|  \____/|__|   
                            \/         \/       \/     \/     \/                   
            </pre>
        </div>

        <div class="w-2/5 bg-[#2F2F2F] backdrop-blur-3xl rounded-lg shadow-xl p-8 bg-gradient-to-br ">

            <form method="POST" action="/" id="mainForm" enctype="multipart/form-data">
                <div class="form-group flex justify-center mx-[45%]">
                    <label for="modeToggle" class="inline-flex items-center p-2 rounded-md cursor-pointer dark:text-gray-100">
                        <input id="modeToggle" type="checkbox" class="hidden peer" name="mode">
                        <span class="px-4 py-2 rounded-l-md dark:bg-[#2e8b57] peer-checked:dark:bg-[#2C3E50]" data-value="IDOR">IDOR</span>
                        <span class="px-4 py-2 rounded-r-md dark:bg-[#2C3E50] peer-checked:dark:bg-[#2e8b57]" data-value="BAC">BAC</span>
                    </label>
                    <input type="hidden" name="modeValue" id="modeValue">
                </div>
                
                
                <div class="form-group flex flex-col items-center mx-[7%]">
                    <label class="mb-2 text-lg font-semibold dark:text-[#FFA500] ">Select Depth:</label>
                    <div class="inline-flex items-center p-2 rounded-md cursor-pointer dark:text-gray-100 bg-[#2F2F2F]">
                        <input type="hidden" name="depthValue" id="depthValue">
                        
                        <span class="px-4 py-2 rounded-l-md cursor-pointer dark:bg-gray-700 text-white depth-option" data-value="High">High</span>
                        <span class="px-4 py-2 cursor-pointer dark:bg-gray-700 text-white depth-option" data-value="Medium">Medium</span>
                        <span class="px-4 py-2 rounded-r-md cursor-pointer dark:bg-gray-700 text-white depth-option" data-value="Low">Low</span>
                    </div>
                </div>
                
                

               <!-- IDOR Mode Fields -->
<div id="idorGroup" class="form-group space-y-4">
    <div class="form-group flex flex-col">
        <label for="url" class="mb-1 font-semibold mx-auto block text-center w-fit">Enter the URL:</label>
        <input type="text" id="url" name="url" placeholder="https://example.com" class="p-2 border rounded-md mx-[15%] w-2/3">
    </div>
    <div class="form-group flex flex-col">
        <label for="url" class="mb-1 font-semibold mx-auto block text-center w-fit">Enter any associated cookie:</label>

        <input type="text" id="cookie" name="cookie" placeholder="session-cookie" class="p-2 border rounded-md mx-[15%] w-2/3">
    </div>
</div>

<!-- BAC Mode Fields -->
<div id="bacGroup" class="form-group space-y-4" style="display:none;">
    <div class="form-group flex flex-col">
        <label for="bac_file" class="mb-1 font-semibold mx-[25%]">Upload a .txt file with BAC URLs:</label>
        <input type="file" name="bac_file" id="bac_file" accept=".txt" class="p-2 border rounded-md mx-[15%] w-2/3">
    </div>
    <div class="form-group flex flex-col">
        <label for="lower_token" class="mb-1 font-semibold mx-[25%]">Enter the lower privilege token:</label>
        <input type="text" id="lower_token" name="lower_token" placeholder="ha5da6gahfafkajjhe" class="p-2 border rounded-md mx-[15%] w-2/3">
    </div>
    <div class="form-group flex flex-col">
        <label for="higher_token" class="mb-1 font-semibold mx-[25%]">Enter the higher privilege token:</label>
        <input type="text" id="higher_token" name="higher_token" placeholder="ha5da6gahfafkajjhe" class="p-2 border rounded-md mx-[15%] w-2/3">
    </div>
</div>

<!-- Submit Button -->
<button class="btn bg-[#2e8b57] text-white px-4 py-2 rounded-md mt-4 mx-[41%]">Submit</button>

            </form>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const modeToggle = document.getElementById('modeToggle'); // The checkbox
        const modeValue = document.getElementById('modeValue'); // Hidden input field for form submission
    
        const idorGroup = document.getElementById('idorGroup');
        const bacGroup = document.getElementById('bacGroup');
    
        const urlField = document.getElementById('url');
        const bacFileField = document.getElementById('bac_file');
    
        const lowerToken = document.getElementById('lower_token');
        const higherToken = document.getElementById('higher_token');
    
        function toggleFormGroups() {
            if (modeToggle.checked) {
                // BAC mode selected
                modeValue.value = "BAC";
                idorGroup.style.display = 'none';
                bacGroup.style.display = 'block';
    
                // BAC fields required
                bacFileField.required = true;
                lowerToken.required = true;
                higherToken.required = true;
    
                // IDOR fields not required
                urlField.required = false;
            } else {
                // IDOR mode selected
                modeValue.value = "IDOR";
                idorGroup.style.display = 'block';
                bacGroup.style.display = 'none';
    
                // IDOR fields required
                urlField.required = true;
                bacFileField.required = false;
    
                // BAC fields not required
                lowerToken.required = false;
                higherToken.required = false;
            }
        }
    
        // Listen for toggle change
        modeToggle.addEventListener('change', toggleFormGroups);
        toggleFormGroups(); // Initialize state on page load
    });

    document.addEventListener('DOMContentLoaded', function() {
    const depthValue = document.getElementById('depthValue');
    const depthOptions = document.querySelectorAll('.depth-option');

    depthOptions.forEach(option => {
        option.addEventListener('click', () => {
            // Remove active styles from all options
            depthOptions.forEach(opt => opt.style.backgroundColor = ""); 

            // Add active style to selected option
            option.style.backgroundColor = "#2e8b57"; // Sea Green color

            // Update hidden input value
            depthValue.value = option.getAttribute('data-value');
        });
    });

    // Set default selection
    depthOptions[0].click(); // Default to "High"
});


    </script>
    
{% endblock %}
