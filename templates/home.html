{% extends "base.html" %}

{% block head %}
<title>IDORnator</title>
<link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
{% endblock %}

{% block body %}
<div class="container">
    <div class="header">
        <pre>
            .___________   ________ __________               __                
            |   \______ \  \_____  \\______   \ ____ _____ _/  |_  ___________ 
            |   ||    |  \  /   |   \|       _//    \\__  \\   __\/  _ \_  __ \
            |   ||    `   \/    |    \    |   \   |  \/ __ \|  | (  <_> )  | \/
            |___/_______  /\_______  /____|_  /___|  (____  /__|  \____/|__|   
                        \/         \/       \/     \/     \/                   
        </pre>
    </div>
    <form method="POST" action="/" id="mainForm" enctype="multipart/form-data">
        <div class="form-group">
            <label for="mode">Enter the Mode:</label>
            <select name="mode" id="mode" required>
                <option value="IDOR">IDOR</option>
                <option value="BAC">BAC</option>
            </select>
        </div>
        <div class="form-group">
            <label for="Depth">Enter the Depth:</label>
            <select name="Depth" id="Depth" required>
                <option value="High">High</option>
                <option value="Medium">Medium</option>
                <option value="Low">Low</option>
            </select>
        </div>

        <!-- IDOR Mode Fields -->
        <div id="idorGroup" class="form-group">
            <div class="form-group">
                <label for="url">Enter the URL:</label>
                <input type="text" id="url" name="url" placeholder="https://example.com">
            </div>
            <div class="form-group">
                <label for="cookie">Enter any associated cookie:</label>
                <input type="text" id="cookie" name="cookie" placeholder="session-cookie">
            </div>
        </div>
        
        <!-- BAC Mode Fields -->
        <div id="bacGroup" class="form-group" style="display:none;">
            <div class="form-group">
                <label for="bac_file">Upload a .txt file with BAC URLs:</label>
                <input type="file" name="bac_file" id="bac_file" accept=".txt">
            </div>
            <div class="form-group">
                <label for="lower_token">Enter the lower privilege token:</label>
                <input type="text" id="lower_token" name="lower_token" placeholder="ha5da6gahfafkajjhe">
            </div>
            <div class="form-group">
                <label for="higher_token">Enter the higher privilege token:</label>
                <input type="text" id="higher_token" name="higher_token" placeholder="ha5da6gahfafkajjhe">
            </div>
        </div>
        
        <button class="btn" type="submit">Submit</button>
    </form>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const modeSelect = document.getElementById('mode');
    const idorGroup = document.getElementById('idorGroup');
    const bacGroup = document.getElementById('bacGroup');

    const urlField = document.getElementById('url');
    const bacFileField = document.getElementById('bac_file');

    const lowerToken = document.getElementById('lower_token');
    const higherToken = document.getElementById('higher_token');

    function toggleFormGroups() {
        if (modeSelect.value === 'IDOR') {
            idorGroup.style.display = 'block';
            bacGroup.style.display = 'none';

            // IDOR fields required
            urlField.required = true;
            bacFileField.required = false;

            // BAC fields not required
            lowerToken.required = false;
            higherToken.required = false;
        } else if (modeSelect.value === 'BAC') {
            idorGroup.style.display = 'none';
            bacGroup.style.display = 'block';

            // IDOR fields not required
            urlField.required = false;

            // BAC fields required
            bacFileField.required = true;
            lowerToken.required = true;
            higherToken.required = true;
        }
    }

    modeSelect.addEventListener('change', toggleFormGroups);
    toggleFormGroups();
});
</script>
{% endblock %}
