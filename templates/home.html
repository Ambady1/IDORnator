{% extends "base.html" %}

{% block head %}
<title>IDORnator</title>
<link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
{% endblock %}

{% block body %}
<div class="container">
    <div class="header">
        <pre>
            .___________   ________ __________               __                
            |   \______ \  \_____  \\______   \ ____ _____ _/  |_  ___________ 
            |   ||    |  \  /   |   \|       _//    \\__  \\   __\/  _ \_  __ \
            |   ||    `   \/    |    \    |   \   |  \/ __ \|  | (  <_> )  | \/
            |___/_______  /\_______  /____|_  /___|  (____  /__|  \____/|__|   
                        \/         \/       \/     \/     \/                   
                                                                               
                                                                                                                    
        </pre>
    </div>
    <form method="POST" action="/" id="mainForm">
        <div class="form-group">
            <label for="mode">Enter the Mode:</label>
            <select name="mode" id="mode" required>
                <option value="IDOR">IDOR</option>
                <option value="BAC">BAC</option>
            </select>
        </div>
        <div class="form-group">
            <label for="Depth">Enter the Depth:</label>
            <select name="Depth" id="Depth" required>
                <option value="High">High</option>
                <option value="Medium">Medium</option>
                <option value="Low">Low</option>
            </select>
        </div>
        
        <div id="urlGroup" class="form-group" style="display:block;">
            <div class="form-group">
            <label for="url">Enter the URL:</label>
            <input type="text" id="url" name="url" placeholder="https://example.com" required>
            </div>
            <div class="form-group">
                <label for="cookie">Enter any associated cookie</label>
                <input type="text" id="cookie" name="cookie" placeholder="session-cookie">
            </div>
        </div>
        
        <div id="tokenGroup" class="form-group" style="display:none;">
            <div class="form-group">
                <label for="lower">Enter the lower privilege token:</label>
                <input type="text" id="lower" name="lower_token" placeholder="ha5da6gahfafkajjhe" required>
            </div>
            <div class="form-group">
                <label for="higher">Enter the higher privilege token:</label>
                <input type="text" id="higher" name="higher_token" placeholder="ha5da6gahfafkajjhe" required>
            </div>
        </div>
        
        <button class="btn" type="submit">Submit</button>
    </form>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const modeSelect = document.getElementById('mode');
    const urlGroup = document.getElementById('urlGroup');
    const tokenGroup = document.getElementById('tokenGroup');

    // Function to toggle form groups based on selected mode
    function toggleFormGroups() {
        if (modeSelect.value === 'IDOR') {
            urlGroup.style.display = 'block';
            tokenGroup.style.display = 'none';
            
            // Make URL required and disable token inputs
            document.getElementById('url').required = true;
            document.getElementById('lower').required = false;
            document.getElementById('higher').required = false;
        } else if (modeSelect.value === 'BAC') {
            urlGroup.style.display = 'none';
            tokenGroup.style.display = 'block';
            
            // Make token inputs required and disable URL input
            document.getElementById('url').required = false;
            document.getElementById('lower').required = true;
            document.getElementById('higher').required = true;
        }
    }

    // Add event listener to mode select
    modeSelect.addEventListener('change', toggleFormGroups);

    // Initial setup on page load
    toggleFormGroups();
});
</script>
{% endblock %}